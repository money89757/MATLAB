# 矩阵运算
假设有一个m*n阶的矩阵A,如果用符号i表示它的行下标,用符号j表示它的列下标  
那么这个矩阵中第i行、第j列的元素就可以表示为A(i,j).  
例如有一个3*4阶的矩阵B,若要把它存储在计算机中,其存放次序为：

|次序|元素|次序|元素|次序|元素|次序|元素|
|----|----|----|----|----|----|----|----|
|1|B(1,1)|4|B(1,2)|7|B(1,3)|10|B(1,4)|
|2|B(2,1)|5|B(2,2)|8|B(2,3)|11|B(2,4)|
|3|B(3,1)|6|B(3,2)|9|B(3,3)|12|B(3,4)|

作为矩阵的特例，一维数组或者说向量元素是依其元素本身的先后次序进行存储的。  
`必须指出，不是所有的高级语言都是这样规定矩阵(或数组)元素的次序，例如C语言就是按行的先后顺序来存放数组元素，即存完第1行后，再存第2行，依次类推。这一点对正确使用高级语言的接口及时十分有益`。


## 矩阵元素的表示及相关操作
1. 元素的下标表示法
    1. 全下标方式：用行下标和列下标来表示是矩阵中的第一个元素  ，这是一个被普遍接受和采用的方法。对一个m*n阶的矩阵A,  其第 i 行、第j列的元素用全下标方式就表示成A(i,j).  
    2. 单下标方式：将矩阵元素按存储次序的先后用单个数码顺序地  连续编号。仍以m*n阶的矩阵A为例，全下标元素A(i,j)对应的单   线标便是A(s),其中s=(j-1) * m+i;

`必须指出，i,j,s这些下标符号,不能只将其视为单数值下标，也可以理解为  用向量表示的一组下标。`

```
>>A=[1 2 3;4 5 6;7 8 9]
A=
  1 2 3   \1/ \4/ \7/
  4 5 6   \2/ \5/ \8/
  7 8 9   \3/ \6/ \9/

>>A(2,3),A(6) %显示矩阵A第1、2两行的第3列的元素值
              %显示单下标元素A(6)的值
ans = 4
ans = 7

>>A(1:2,3)    %显示矩阵A第1、2两行的第3列的元素值
ans=
    3
    4

>>A(6:8)      %显示矩阵A单下标第6~8号元素的值,此处是用
              一向量表示一下标区间

ans=
    7 3 4

```

2. 矩阵元素的赋值  
      1. 全下标方式：在给矩阵的单个或多个元素赋值时，采用全下标方式接受。

```
>>A(1:2,1:3)=[1 1 1;1 1 1]  %可用一矩阵A的1~2行1~3列
                            %的全部元素赋值为1
A=
  1 1 1
  1 1 1
>>A(3,2)=2                  %给原矩阵中并不存在的元素下                          %标赋值会扩充矩阵阶数，注意
A=                          %补零原则
  1 1 1
  1 1 1
  0 0 2

```      
      2. 单下标方式：在给矩阵的单个或多个元素赋值是，  采用单下标方式接受。

      3. 全元素方式：将矩阵B的所有元素全赋值给矩阵A,即A(：)=B,  不要求A、B同阶，只要求元素个数相等。

3. 矩阵元素的删除

```
>>A(2:3，2：3)=[1 1;2 2]
A=
  0 0 0
  0 1 1
  0 2 2

>>=A(2,:)=[]  %删除A矩阵的第2行,"："可表示所有行或列

A=
  0 0 0
  0 2 2
>>A(1:2)=[]  %删除新矩阵A的前两个单下标元素，矩阵变成向量

A=
  0 2 0 2    %删除所有元素

A=
  []

```

## 矩阵的创建
1. 直接输入法
2. 抽取法
3. 拼接法
4. 函数法
5. 拼接函数
6. 变形函数法
7. 加载法
8. M文件法
矩阵时MATLAB特别引入的量,所以在表达时，必须给出一些相关的约定与其他量区别，这些约定是：
1. 矩阵的所用元素必须放在方括号内；
2. 每行的元素之间需用逗号或空格隔开；
3. 矩阵的行与行之间用分号或回车符分隔；
4. 元素可以是数值或表达式。

---

#### 1. 抽取法
  *  用全下标方式

```
>>a=[1 2 3 4;5 6 7 8;9 10 11 12;13 14 15 16]

>>b=[1:3,2:3]%取矩阵A行数为1~3,列数为2~3的元素构成子矩阵b
b=
  2  3
  6  7
  10 11

c=a([1 3],[2 4])%取矩阵的第1、3行，列数为2、4列构成子矩阵
c=
  2  4
  10 12

d=a(4,:)%取矩阵A的第4行，所有列,": "可表示所有行或列
d=13 14 15 16

e=A([2 4],end)%取矩阵的第2、4行，end代表某一维数的最大值
e=
  8
  16

```

  * 用单下标方式

```
>>a=[1 2 3 4;5 6 7 8;9 10 11 12;13 14 15 16]
a=
  1  2  3  4
  5  6  7  8
  9  10 11 12
  13 14 15 16

b=a([4:6;3 5 7;12:14])
b=
  13 2 6
  9  2 10
  15 4 8
  %a中取出单下标4~6的元素做第1行、单下标3、5、7这3个元素做
  %第二行，单下标12~14的元素做第3行，生成一个3*3阶新矩阵b

  同理
b=a([4:6,[3 5 7];12:14])

```
#### 2. 拼接法
行数与行数相同的小矩阵可在列方向扩展拼接成更大的矩阵。同理，
列数与列数相同的小矩阵可在行方向扩展拼接成更大的矩阵。

```
>>a=[1 2 3;4 5 6;7 8 9],b=[9 8;7 6;5 4],c=[4 5 6;7 8 9]
a=
  1 2 3
  4 5 6
  7 8 9
b=
  9 8
  7 6
  5 4
c=
  4 5 6
  7 8 9
>>e=[a b;b a]   %行列两个方向同时拼接,注意行、列数的霹匹配问题
  1 2 3 9 8
  4 5 6 7 6
  9 8 1 2 3
  7 6 4 5 6
  5 4 7 8 9

>>f=[a;c]       %a,c列数相同，沿行向扩展拼接
  1 2 3
  4 5 6
  7 8 9
  4 5 6
  7 8 9
```

#### 3. 函数法
|函数|功能|
|---|---|
|zeros(m,n)|生成m*n阶的全0矩阵|
|ones(m,n)|生成m*n阶的全1矩阵|
|rand(m,n)|生成取值在0~1之间满足均匀分布的随机矩阵|
|randn(m,n)|生成满足正态分布的随机矩阵|
|eye(m,n)|生成m*n阶的单位矩阵|

|函数|功能|函数|功能|
|---|---|---|---|
|compan|Companion矩阵|magic|魔方矩阵|
|gallery|Higham测试矩阵|pascal|帕斯卡矩阵
|hadamard|hadamard矩阵|rosser|经典对称特征值测试矩阵|
|hankel|hankel矩阵|toeplitz|Toeplitz矩阵|
|hilb|Hilbert矩阵|vander|范德蒙矩阵|
|invhilb|反Hibert矩阵|wilkinson|Wilkinson's特征值测试矩阵|
`表中除了eye外，其他函数都能生成三维以上的多维数组，而eye(m,n)可  
生成非方针的单位阵`

#### 4. 拼接函数和变形函数法
拼接函数是指用cat和repmat函数将多个或单个小矩阵或沿行、或沿列  
方向拼接长的一个大矩阵。  
* cat函数的使用格式是:cat(n,A1,A2,A3...),n=1时,表示沿行方向拼接；  
n=2,表示沿列方向拼接。n可以是大于2的数字,此时拼接出的是多维数组。  
* repmat函数的使用格式是：repmat(A,m,n...),m和n分别是沿行和沿列方向  
重复拼接矩阵A的次数。
* reshape函数的使用格式是:reshape(A,m,n..),m和n分别是变形后新矩阵的行列数。

```
>>=A=linspace(2,18,9)
A=
  2 4 6 8 10 12 14 16 18

>>=B=reshape(A,3,3)  %注意新矩阵的排列方
B=
  2  8 14
  4 10 16
  6 12 18


```

#### 5. 加载法
加载法是指将已经存放在外村中的.mat文件读入MATLAB工作空间中。  
这一方法的前提是：必须在外存中事先已保存了该.mat文件且数据文件中的内容  是所需的矩阵。

```
>>load s12_19 %从外存中加载事先保存在可搜索路径中的数据文件s12_19.mat
>>who         %询问加载的矩阵名称

Your variables are:
A

```

#### 6. M文件法
M文件法和加载法其实十分相似，都是将事先保存在外存中的矩阵读入内存  
工作空间中，不同点在于加载法读入的是数据文件(.mat),而M文件法读入的是内容仅为矩阵的.m文件。

---

## 矩阵的代数运算
#### 1. 求矩阵行列式的值
矩阵行列式的值有函数det(A)实现。

#### 2. 矩阵加减、数乘与乘法
矩阵的加减法、数乘和乘法按照运算符来实现

#### 3. 矩阵的逆矩阵
求一个n阶方阵的逆矩阵有inv(A)实现。

#### 4.矩阵的除法
MATLAB保留了除法运算,并规定了矩阵的除法运算法则，又因照顾到解  
不同线性代数方程组的需要，提出里左除和右除的概念。  
左除即A\B=inv(A)* B   
右除即A/B=A*inv(B)  

#### 5. 矩阵的秩
矩阵的秩是线性代数中一个重要的概念,它描述里矩阵的一个数值特征。
在MATLAB中求秩运算是由函数ranK(A)完成。

#### 6. 矩阵的特征值与特征向量
求矩阵`A`的特征值和特征向量的数值解,有两个函数可用：  
[X,λ]=eig(A)  
[X,λ]=eigs(A) 后者因采用迭代法求解,在规模上最多只能给出6个特征值  
和特征向量。  

```
>>A=[1 -3 3;3 -5 3;6 -6 4],[X,Lamda]=eig(A)
A=
  1 -3 3
  3 -5 3
  6 -6 4

X=
  0.4082  0.4082 -0.1203
  0.4082 -0.4082 -0.7595
  0.8165 -0.8165 -0.6393

Lamda=
  4.0000 0 0
  0 -2.0000 0
  0 0 -2.0000

```

Lamda用矩阵对角线方式给出了矩阵`A`的特征值和特征值为λ1=4，λ2=λ3=-2。 而与这些特征值相应特征向量则由`X`的各列来代表，`X`的第1列λ1的特征向量，  第2列式λ2的，其余以此类推。

`矩阵A的某个特征值对应的特征向量不是有限的，更不是唯一的，而是无穷的。`

#### 7. 矩阵的乘幂与开方
矩阵的开方运算也是MATLAB自己定义的，它的依据在于开方所得矩阵相乘正好  
等于被开方的矩阵。矩阵的开方运算由函数sqrtm(A)实现。

#### 8. 矩阵的指数与对数
矩阵的指数与对数运算是一对互逆运算。  
矩阵指数运算的函数有多个：expm()、expm1()、expm2()、expm3()等。  
其中最常用的是expm(A);  
而对数运算则是logm(A);

#### 9. 矩阵转置
矩阵的转置分为共轭转置和非共轭转置两大类。  
就一般`实矩阵`而言，共轭转置与非共轭转置的效果没有区别。  
`复矩阵`在转置的同事实现共轭。  
单纯的转置运算可以用函数transpose(Z)实现,不论实矩阵还是复矩阵都只实现转  置而不做共轭变换。

#### 10. 矩阵的提取与翻转
|函数|功能|
|---|:-------:|
|triu(A)|提取矩阵A的右上三角元素,其余元素补0|
|tril(A)|提取矩阵A的左下三角元素,其余元素补0|
|diag(A)|提取矩阵A的对角线元素|
|flipud(A)|矩阵A沿水平轴上下翻转|
|fliplr(A)|矩阵A沿垂直左右翻转|
|flipdim(A,dim)|矩阵A沿特定轴翻转。dim=1,按行翻转;dim=2,按列翻转|
|rot90(A)|矩阵A整体逆时针旋转90°|
